<app-header></app-header>
<h2>Search City</h2>
<div class="text-filter">
  <form #addForm="ngForm" (ngSubmit)="findCity(addForm)">
    <label for="city">City (State US only)</label>
    <input
      type="text"
      id="city"
      name="city"
      placeholder="Detroit, MI"
      required
      ngModel
    />
    <label for="country">Country</label>
    <input
      type="text"
      id="country"
      name="country"
      placeholder="United States"
      required
      ngModel
    />
    <button>Submit</button>
  </form>
</div>
<h2>Filter by:</h2>
<div>
  <div class="img-filter">
    <img
      src="../../assets/cost-of-living.jpg"
      alt="cost-of-living"
      (click)="toggleMoneyFilter()"
    />
    <p (click)="togglePollutionFilter()">Pollution</p>
    <p (click)="toggleClimateFilter()">Climate</p>
  </div>
  <div
    class="popup-container"
    *ngIf="showClimateFilter || showMoneyFilter || showPollutionFilter"
  >
    <div *ngIf="showMoneyFilter" class="popup">
      <i class="fas fa-times" (click)="toggleMoneyButton()"></i>
      <img
        src="../../assets/single.png"
        alt="moneypic"
        (click)="setMoneyRange(25)"
      />
      <p (click)="setMoneyRange(50)">
        <img src="../../assets/two.png" alt="moneypic" />
        Mid-Range
      </p>
      <p (click)="setMoneyRange(75)">
        <img src="../../assets/three.png" alt="moneypic" />
        Expensive
      </p>
      <p (click)="setMoneyRange(100)">
        <img src="../../assets/four.png" alt="moneypic" />
        Luxury
      </p>
      <button (click)="toggleMoneyButton(); addMoneyFilter()">Submit</button>
    </div>
    <div *ngIf="showPollutionFilter" class="popup">
      <i class="fas fa-times" (click)="togglePollutionButton()"></i>
      <p (click)="setPollutionRange(33)">
        <img src="../../assets/safe.png" alt="safe" /> Safe
      </p>
      <p (click)="setPollutionRange(66)">
        <img src="../../assets/moderate.png" alt="" /> Moderate
      </p>
      <p (click)="setPollutionRange(99)">
        <img src="../../assets/unsafe.png" alt="" /> Unsafe
      </p>
      <button (click)="togglePollutionButton(); addPollutionFilter()">
        Submit
      </button>
    </div>
    <div *ngIf="showClimateFilter" class="popup">
      <i class="fas fa-times" (click)="toggleClimateButton()"></i>
      <p (click)="setClimateRange(33)">
        <img src="../../assets/cold.png" alt="cold" /> Cold
      </p>
      <p (click)="setClimateRange(66)">
        <img src="../../assets/mild.png" alt="mild" /> Mild
      </p>
      <p (click)="setClimateRange(100)">
        <img src="../../assets/hot.png" alt="hot" /> Hot
      </p>
      <button (click)="toggleClimateButton(); addClimateFilter()">
        Submit
      </button>
    </div>
  </div>
</div>
<div class="map">
  <google-map [zoom]="zoom" [center]="center" width="80vw">
    <map-marker
      #markerElem
      *ngFor="let marker of markers"
      [position]="marker.position"
      [label]="marker.label"
      [title]="marker.title"
      [options]="{ icon: marker.icon }"
      (mapClick)="openInfo(markerElem, marker.info)"
      (mapDblclick)="dblClick(markerElem, marker.info, marker.position)"
    >
    </map-marker>
    <map-info-window *ngFor="let city of popularCities">
      <h3>{{ infoContent?.city }}, {{ infoContent?.country }}</h3>
      <h4>Ranked #{{ infoContent?.rank }}</h4>
      <h5>Quality of Life Index: {{ infoContent?.qol }}</h5>
      <a (click)="moreInfo(city)">More Info</a>
    </map-info-window>
  </google-map>
</div>
<div *ngFor="let city of popularCities; index as i">
  <div *ngIf="i < 10">
    <p>{{ city.country }}</p>
    <button><i class="far fa-star"></i></button>
    <p>{{ city.city_name }}</p>
  </div>
</div>
